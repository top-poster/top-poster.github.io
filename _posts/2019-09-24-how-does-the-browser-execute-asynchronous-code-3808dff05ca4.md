---
layout: post
title: "브라우저는 어떻게 비동기 코드를 실행합니까?"
author: "Logger"
thumbnail: "undefined"
tags: 
---


![Image for post](https://miro.medium.com/max/8752/1*qN0K0Sy3Qlgi-qh56Bw_Sg.jpeg)

이 글은 자바스크립트 엔진이 어떻게 동작하고 브라우저 API와 상호 작용하여 정상적인 실행 스레드를 차단하지 않고 비동기 코드를 실행할 수 있는지 단계별로 설명한다.

제일 먼저. 이것은 빠른 읽기가 아니다. 저는 일상적인 예시를 사용하여 이 모든 것이 어떻게 작동하는지 이해하려고 노력하지만, 이 모든 것을 읽고 이해하려면 상당한 시간이 필요합니다.

카일과 윌 센턴스에게서 들은 과정을 바탕으로 기사를 작성했어요.

# JavaScript 엔진 및 브라우저 API

먼저 자바스크립트 엔진의 일부와 브라우저와의 상호 작용 방식에 대해 설명하겠습니다. 처음에 너무 많은 정보처럼 들리더라도 걱정하지 마세요.

저는 여러분이 그것들을 따르는 예들을 읽을 때쯤에는 모든 것이 이치에 맞기를 바랍니다. 그리고 여기 돌아와서 다시 읽을 수도 있습니다.

아시다시피 JavaScript 엔진은 싱글 스레드입니다. 즉, 한 개의 명령만 동시에 수행할 수 있습니다. 자바스크립트의 설계는 그것에 기초한다.

![Image for post](https://miro.medium.com/max/1914/1*xUQk5s8VWdzFp780U4fhww.png)

비동기 코드를 처리할 두 대기열:

# JavaScript 실행

코드 실행 프로세스에는 두 가지 부분이 있습니다. 저는 몇 가지 용어를 소개하고 싶습니다.

## 실행의 실

프로그램의 전반부라고도 합니다.

첫 번째 구문 분석 및 코드 라인별 실행입니다. 코드가 나타나듯이 말이죠). 변수와 함수를 할당하고, 코드는 실행 컨텍스트에서 실행된다. (이 부분은 동기적으로 실행됨)

## 지연코드실행

프로그램의 후반부라고도 합니다.

이 코드는 정상적인 실행 스레드를 거친 후 특정 시점에 실행됩니다. 예를 들어 `setTimeout`을 호출하거나 서버에서 API 요청 데이터가 반환될 때까지 기다리면 이러한 현상이 발생합니다. 기다리는 시간에 자바스크립트 실행 스레드를 차단해서는 안 됩니다.

## 웹 API

브라우저는 스레드를 차단하지 않고 비동기 코드를 실행하는 데 기여하는 몇 가지 기능을 제공합니다. 이러한 기능을 웹 API(브라우저)라고 합니다.

타이머와 같이 `setTimeout` 및 `setTimeout`을 인식할 수 있습니다.Interval` 메서드 라이브, 가져오기 메서드에서 사용되는 `XMLHttpRequest`, 콘솔 API, DOM 및 웹 스토리지 API입니다. 그 중 일부는 다이어그램에 나와 있습니다.

# 코드 실행: setTimeout 및 약속

간단한 예제의 도움을 받아 개념을 설명하고 싶기 때문에 setTimeout이라고 할 때 어떤 일이 일어나는지 자세히 설명하고 다음으로 Promise를 사용하여 다소 유사한 시나리오를 살펴보도록 하겠습니다.

## 예: 'setTimeout'

간단한 일상 시나리오로 이 사례를 살펴보자. 일상에서 아침에 일어나면 딸에게 키스하고 두 번째로 필요한 것은 커피 한 잔입니다.

그래서, 계획은 커피를 마시는 거 맞죠?

나는 커피머신을 켜고 에스프레소를 누른다. 이 예를 더 쉽게 만들기 위해, 커피 기계가 커피를 만드는 데 항상 동일한 시간이 소요된다고 가정해 보자. 이 시간은 겨우 6만 ms(1분)입니다.

그래서, 우리는 커피머신에게 커피 준비를 시작하라고 "요청"합니다. 주목하세요. 제가 하는 것이 아니라, 외부 메커니즘이 저를 위해 하는 것입니다. 그러는 동안, 나는 친구에게 문자 쓰는 것과 같은 다른 것들을 할 수 있어.

기계가 우리의 커피 준비를 마치면, 그것은 준비되었음을 알려준다. 당장 마시기 시작할 필요는 없는데, 우리가 지금 하고 있는 일은 모두 끝내고 커피를 마시는 행위는 나중으로 남겨둘 수 있다는 뜻이다.

`커피를 마실 생각이 있다`, `기계의 버튼을 눌러 커피 준비를 시작한다`, `친구에게 문자 쓰기` 등의 액션은 프로그램 전반부에서 벌어지는 일이다.

정확히 말하면, `커피 마시기`의 적절한 행동은 연기된 것이고, 프로그램의 후반부에서 미래의 어느 시점에 일어나는 것이다.

코드로 바꿔보자.

## 단계별 타임라인

상황을 더 쉽게 만들기 위해, 각 명령이 실행되는 데 1ms가 소요된다고 가정해봅시다. 어떻게 실행되는지 밀리초 단위로 볼 수 있습니다.

실행의 모든 단계를 안내하는 슬라이드를 따르십시오.

## 하지만 약속은 어떻게 되는가?

JavaScript에서 Promise 개체는 미래 데이터의 자리 표시자를 나타냅니다.

예를 들어, 서버에 요청을 하기 위해 가져오기 기능을 호출할 때 다음과 같은 두 가지 작업이 수행됩니다.

Promise 개체가 생성되면 브라우저의 웹 API를 사용하여 코드가 실행됩니다.

.then() 메서드는 "value" 속성이 설정된 후 호출되기를 원하는 콜백을 첨부합니다. 이러한 방법은 내부적으로 등록됩니다. 일단 `가치`가 정해지면, 그것은 모든 등록된 방법을 부른다.

## 예: 약속

다시 일상으로 돌아가서 비유를 해보죠. 나는 또 커피를 마시고 있는데 이번에는 커피숍에서 받고 있어. 저는 카운터에서 "라테 마키아토"를 주문합니다. 이 사람은 저에게 번호를 적은 표를 미래에 커피를 사겠다는 약속으로 줍니다.

커피를 받으면 "라떼 마끼아또 한잔" 마실 생각이 있어요. 이것은 미래에 일어날 지연된 행동이다.

제 주문 전에 몇 가지 주문이 있어서, 다 될 때까지 기다려야 할 것 같아요. 나중에, 어느 순간 웨이터가 그것을 내 테이블로 가져다 줄 거예요. 그 동안 다른 일을 할 수 있어서 미디엄 기사를 계속 쓰기로 했습니다.

`커피를 달라`, `티켓을 달라`, `내 기사 쓰기`는 프로그램의 첫 번째 부분에서 일어난다.

미래에는 커피가 준비되면 웨이터가 라떼 마키아토를 가져다 준다. 그래도 마지막 단락은 다 써야 하고 그래야 커피를 마실 수 있어.

`라떼마끼아또 마시기` 행위는 프로그램의 2부에서 일어나는데, 내가 커피를 준비했을 때에만 일어난다.

코드로 바꿔보자.

## 단계별 타임라인

상황을 더 쉽게 만들기 위해 각 명령이 실행되는 데 1ms가 소요된다고 가정해 봅시다. 그러면 각 명령어가 밀리초 단위로 어떻게 발생하는지 볼 수 있습니다.

실행의 모든 단계를 안내하는 슬라이드를 따르십시오.

# 결론

기본 개념, 자바스크립트 엔진 구성 요소 및 코드 실행은 프로그램의 전반과 후반부에서 이루어집니다.

그런 다음 매우 간단한 예를 들어 `setTimeout`이 작동하는 방식에 대해 타임라인에 삽입하여 논의하였다. 우리는 또한 약속을 사용해서 비슷한 예를 들었습니다.

이런 것들이 까다로운 개념들이긴 하지만, 쉽게 이해할 수 있을 만큼 간단하게 만들 수 있었으면 좋겠어요. 비동기식 코드를 작성하는 순간에 문제가 발생하지 않도록 마스터하는 것이 중요합니다.

읽어주셔서 감사합니다!

# 자원.